<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>4.Y ‚Äì Sp√∏rgeskema ‚Üí Print (personligt matematik-ark)</title>

  <style>
    :root{
      --bg1:#fff7ed;
      --bg2:#eff6ff;
      --ink:#0f172a;
      --muted:#475569;
      --card:#ffffff;
      --line:#e2e8f0;
      --accent:#22c55e;
      --accent2:#3b82f6;
      --radius:22px;
      --shadow: 0 10px 25px rgba(15, 23, 42, .10);
      --max: 980px;
      --tap: 52px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--ink);
      background:
        radial-gradient(900px 600px at 20% 10%, rgba(34,197,94,.18), transparent 55%),
        radial-gradient(900px 600px at 90% 20%, rgba(59,130,246,.18), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
    }
    header{
      max-width:var(--max);
      margin:0 auto;
      padding:18px 14px 8px;
    }
    .hero{
      background: linear-gradient(180deg, rgba(255,255,255,.88), rgba(255,255,255,.70));
      border:1px solid rgba(226,232,240,.95);
      border-radius: 28px;
      box-shadow: var(--shadow);
      padding:16px 16px;
      display:flex;
      gap:14px;
      align-items:flex-start;
      flex-wrap:wrap;
    }
    h1{
      margin:0;
      font-size: clamp(22px, 3.3vw, 34px);
      letter-spacing:.2px;
      font-weight:900;
    }
    .lead{
      margin:6px 0 0;
      color:var(--muted);
      font-size: 15px;
      line-height:1.35;
      max-width: 75ch;
    }
    .pillRow{
      margin-top:10px;
      display:flex;
      flex-wrap:wrap;
      gap:8px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:9px 11px;
      border-radius: 999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.85);
      font-size: 13px;
      color: var(--muted);
    }
    main{
      max-width:var(--max);
      margin:0 auto;
      padding: 10px 14px 22px;
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    .card{
      background: var(--card);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardHead{
      padding:14px 14px 0;
    }
    .cardTitle{
      margin:0;
      display:flex;
      align-items:center;
      gap:10px;
      font-size: 18px;
      font-weight:900;
    }
    .sub{
      margin:8px 0 12px;
      color: var(--muted);
      font-size: 14px;
      line-height:1.35;
    }
    .content{ padding: 0 14px 14px; }
    .q{
      border-top:1px solid var(--line);
      padding:14px 0;
    }
    .q:first-child{ border-top:0; }
    .qTop{
      display:flex;
      gap:10px;
      align-items:flex-start;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .qNum{
      font-weight:900;
      min-width: 40px;
      height: 40px;
      border-radius: 14px;
      display:grid;
      place-items:center;
      background: rgba(59,130,246,.12);
      color: var(--accent2);
    }
    .qText{
      flex:1;
      font-weight:900;
      font-size: 16px;
    }
    .qRule{
      font-size: 12px;
      color: var(--muted);
      background: rgba(59,130,246,.10);
      border: 1px solid rgba(59,130,246,.20);
      padding: 7px 10px;
      border-radius: 999px;
      white-space:nowrap;
    }
    .options{
      margin-top:10px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    label.opt{
      display:flex;
      gap:12px;
      align-items:flex-start;
      padding: 12px 12px;
      border-radius: 18px;
      border:1px solid var(--line);
      background: rgba(248,250,252,.95);
      cursor:pointer;
      min-height: var(--tap);
      transition: transform .04s ease, box-shadow .12s ease, border-color .12s ease;
    }
    label.opt:hover{
      border-color: rgba(59,130,246,.35);
      box-shadow: 0 8px 18px rgba(59,130,246,.10);
    }
    input[type="radio"], input[type="checkbox"]{
      margin-top: 4px;
      transform: scale(1.25);
      accent-color: var(--accent2);
    }
    .optText{
      font-size: 15px;
      font-weight: 700;
    }
    .field{
      width:100%;
      padding: 12px 12px;
      border-radius: 16px;
      border: 1px solid var(--line);
      background: white;
      font-size: 15px;
      outline:none;
      min-height: var(--tap);
    }
    .field:focus{
      border-color: rgba(34,197,94,.5);
      box-shadow: 0 0 0 4px rgba(34,197,94,.15);
    }
    .row2{
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
      min-width:220px;
    }
    .inline{
      margin-top:10px;
      display:grid;
      gap:10px;
    }
    .actions{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      padding: 12px 14px 14px;
      border-top: 1px solid var(--line);
      background: rgba(248,250,252,.8);
    }
    .btns{ display:flex; gap:10px; flex-wrap:wrap; }
    button{
      border:0;
      cursor:pointer;
      border-radius: 16px;
      padding: 12px 14px;
      font-weight: 900;
      font-size: 14px;
      min-height: var(--tap);
    }
    button:disabled{ opacity:.7; cursor:not-allowed; }
    .primary{
      color:white;
      background: linear-gradient(180deg, rgba(34,197,94,.95), rgba(34,197,94,.80));
      box-shadow: 0 10px 18px rgba(34,197,94,.18);
    }
    .secondary{
      color:white;
      background: linear-gradient(180deg, rgba(59,130,246,.95), rgba(59,130,246,.80));
      box-shadow: 0 10px 18px rgba(59,130,246,.18);
    }
    .ghost{
      background: white;
      border: 1px solid var(--line);
      color: var(--ink);
      font-weight: 800;
    }
    .hint{
      color: var(--muted);
      font-size: 13px;
      display:flex;
      align-items:center;
      gap:8px;
    }
    textarea{
      width:100%;
      min-height: 260px;
      padding: 12px 12px;
      border-radius: 18px;
      border:1px solid var(--line);
      background: #0b1220;
      color: #e5e7eb;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 12.8px;
      line-height: 1.4;
      outline:none;
      resize: vertical;
    }
    .note{
      margin:10px 0 0;
      font-size: 13px;
      color: var(--muted);
    }
    .toast{
      position: fixed;
      right: 14px;
      bottom: 14px;
      background: rgba(15,23,42,.95);
      color: white;
      padding: 10px 12px;
      border-radius: 16px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(255,255,255,.12);
      display:none;
      max-width: 360px;
      font-size: 13px;
    }
    .toast.show{ display:block; }

    /* Teacher-only UI hidden on screen */
    .teacherOnly{ display:none; }

    /* Print-ark (bogside) */
    .printSheet{
      display:none;
      background:white;
      border:1px solid var(--line);
      border-radius: 18px;
      padding: 16px;
      box-shadow: var(--shadow);
      margin-top: 12px;
    }
    .printTitle{
      font-weight: 900;
      margin: 0 0 8px;
      font-size: 14px;
      color: #111827;
    }
    #resultOut{
      margin:0;
      white-space: pre-wrap;
      font-family: "Times New Roman", Times, serif;
      font-size: 13.5px;
      line-height: 1.35;
      color: #111827;
    }

    @media (min-width: 980px){
      main{ grid-template-columns: 1fr; align-items:start; }
      .row2{ grid-template-columns: 1fr 1fr; }
    }

    @media print{
      header, .card[aria-label="Sp√∏rgeskema"] { display:none !important; }
      textarea, .actions, .toast, .note { display:none !important; }
      body{ background: white !important; }
      main{ display:block; padding:0; margin:0; max-width: none; }
      .card{ box-shadow:none; border:0; }

      /* force print sheet visible */
      #printSheet{ display:block !important; border:0; border-radius:0; box-shadow:none; padding:0; margin:0; }
      #resultOut{ display:block !important; }
      .printTitle{ font-size: 14px; margin-bottom: 10px; }
    }
  </style>
</head>

<body>
  <header>
    <div class="hero">
      <div style="flex:1; min-width:260px;">
        <h1>üß† 4.Y sp√∏rgeskema ‚Üí Print</h1>
        <p class="lead">
          S√¶t kryds. N√•r du er f√¶rdig, laver siden automatisk et personligt matematik-ark og √•bner print.
        </p>
        <div class="pillRow">
          <span class="pill">‚úÖ Svar under hinanden</span>
          <span class="pill">‚ö°Ô∏è Auto via API</span>
          <span class="pill">üñ®Ô∏è Print direkte</span>
        </div>
      </div>

      <div class="row2">
        <input class="field" id="studentName" placeholder="‚úçÔ∏è Navn" autocomplete="off" />
        <input class="field" id="studentClass" placeholder="üè´ Klasse (fx 4Y)" autocomplete="off" />
      </div>
    </div>
  </header>

  <main>
    <!-- FORM -->
    <section class="card" aria-label="Sp√∏rgeskema">
      <div class="cardHead">
        <h2 class="cardTitle">üß© Sp√∏rgeskema</h2>
        <p class="sub">Nogle sp√∏rgsm√•l har ‚Äúmax 2‚Äù. Du m√• gerne v√¶lge flere, n√•r der st√•r det.</p>
      </div>

      <form id="survey" class="content">
        <!-- 1 -->
        <div class="q">
          <div class="qTop">
            <div class="qNum">1</div>
            <div class="qText">üß† N√•r jeg arbejder med matematik ‚Ä¶</div>
            <div class="qRule">max 1</div>
          </div>
          <div class="options" role="radiogroup" aria-label="Q1">
            <label class="opt"><input type="radio" name="q1" value="Det f√∏les let for mig"><span class="optText">Det f√∏les let for mig</span></label>
            <label class="opt"><input type="radio" name="q1" value="Det f√∏les ok ‚Äì noget er let, noget er sv√¶rt"><span class="optText">Det f√∏les ok ‚Äì noget er let, noget er sv√¶rt</span></label>
            <label class="opt"><input type="radio" name="q1" value="Det f√∏les sv√¶rt, men jeg vil gerne blive bedre"><span class="optText">Det f√∏les sv√¶rt, men jeg vil gerne blive bedre</span></label>
            <label class="opt"><input type="radio" name="q1" value="Det afh√¶nger af, hvad vi arbejder med"><span class="optText">Det afh√¶nger af, hvad vi arbejder med</span></label>
          </div>
        </div>

        <!-- 2 -->
        <div class="q">
          <div class="qTop">
            <div class="qNum">2</div>
            <div class="qText">üöÄ N√•r vi starter p√• en ny opgave, vil jeg helst ‚Ä¶</div>
            <div class="qRule">max 1</div>
          </div>
          <div class="options" role="radiogroup" aria-label="Q2">
            <label class="opt"><input type="radio" name="q2" value="Starte med noget let og blive sikker"><span class="optText">Starte med noget let og blive sikker</span></label>
            <label class="opt"><input type="radio" name="q2" value="Starte med noget sv√¶rt og udfordre mig selv"><span class="optText">Starte med noget sv√¶rt og udfordre mig selv</span></label>
          </div>
        </div>

        <!-- 3 -->
        <div class="q">
          <div class="qTop">
            <div class="qNum">3</div>
            <div class="qText">üî¢ Jeg vil gerne blive bedre til ‚Ä¶</div>
            <div class="qRule">flere</div>
          </div>
          <div class="options" aria-label="Q3">
            <label class="opt"><input type="checkbox" name="q3" value="Plus og minus"><span class="optText">Plus og minus</span></label>
            <label class="opt"><input type="checkbox" name="q3" value="Gange"><span class="optText">Gange</span></label>
            <label class="opt"><input type="checkbox" name="q3" value="Division"><span class="optText">Division</span></label>
            <label class="opt"><input type="checkbox" name="q3" value="Br√∏ker (pizza-, kage- og del-tal)"><span class="optText">Br√∏ker (pizza-, kage- og del-tal üçï)</span></label>
            <label class="opt"><input type="checkbox" name="q3" value="M√•ling (tid, penge, l√¶ngde, v√¶gt)"><span class="optText">M√•ling (tid, penge, l√¶ngde, v√¶gt)</span></label>
            <label class="opt"><input type="checkbox" name="q3" value="Problemer og g√•der"><span class="optText">Problemer og g√•der</span></label>
            <label class="opt"><input type="checkbox" name="q3" value="Matematik med historier og fantasi"><span class="optText">Matematik med historier og fantasi</span></label>
          </div>
        </div>

        <!-- 4 -->
        <div class="q">
          <div class="qTop">
            <div class="qNum">4</div>
            <div class="qText">üéÆ Matematik er sjovest for mig, n√•r det handler om ‚Ä¶</div>
            <div class="qRule">flere</div>
          </div>
          <div class="options" aria-label="Q4">
            <label class="opt"><input type="checkbox" name="q4" value="Spil"><span class="optText">Spil</span></label>
            <label class="opt"><input type="checkbox" name="q4" value="Sport"><span class="optText">Sport</span></label>
            <label class="opt"><input type="checkbox" name="q4" value="Gaming"><span class="optText">Gaming</span></label>
            <label class="opt"><input type="checkbox" name="q4" value="Dyr"><span class="optText">Dyr</span></label>
            <label class="opt"><input type="checkbox" name="q4" value="Mad og butikker"><span class="optText">Mad og butikker</span></label>
            <label class="opt"><input type="checkbox" name="q4" value="Musik, dans eller TikTok"><span class="optText">Musik, dans eller TikTok</span></label>
            <label class="opt"><input type="checkbox" name="q4" value="Eventyr, fantasi og magi"><span class="optText">Eventyr, fantasi og magi</span></label>
            <label class="opt"><input type="checkbox" name="q4" value="Virkelige ting fra hverdagen"><span class="optText">Virkelige ting fra hverdagen</span></label>
          </div>
          <div class="inline">
            <input class="field" id="q4other" placeholder="‚úçÔ∏è Uddyb (valgfrit) ‚Ä¶" autocomplete="off" />
          </div>
        </div>

        <!-- 5 -->
        <div class="q">
          <div class="qTop">
            <div class="qNum">5</div>
            <div class="qText">üß© N√•r jeg arbejder bedst, er det fordi ‚Ä¶</div>
            <div class="qRule">max 2</div>
          </div>
          <div class="options" aria-label="Q5">
            <label class="opt"><input type="checkbox" name="q5" value="Jeg kan arbejde i ro"><span class="optText">Jeg kan arbejde i ro</span></label>
            <label class="opt"><input type="checkbox" name="q5" value="Jeg kan tale med andre"><span class="optText">Jeg kan tale med andre</span></label>
            <label class="opt"><input type="checkbox" name="q5" value="Jeg kan bev√¶ge mig lidt"><span class="optText">Jeg kan bev√¶ge mig lidt</span></label>
            <label class="opt"><input type="checkbox" name="q5" value="Jeg kan skifte mellem opgaver"><span class="optText">Jeg kan skifte mellem opgaver</span></label>
            <label class="opt"><input type="checkbox" name="q5" value="Jeg ved pr√¶cis, hvad jeg skal"><span class="optText">Jeg ved pr√¶cis, hvad jeg skal</span></label>
            <label class="opt"><input type="checkbox" name="q5" value="Jeg selv m√• v√¶lge noget"><span class="optText">Jeg selv m√• v√¶lge noget</span></label>
          </div>
        </div>

        <!-- 6 -->
        <div class="q">
          <div class="qTop">
            <div class="qNum">6</div>
            <div class="qText">üë• Jeg arbejder bedst ‚Ä¶</div>
            <div class="qRule">max 1</div>
          </div>
          <div class="options" role="radiogroup" aria-label="Q6">
            <label class="opt"><input type="radio" name="q6" value="Alene"><span class="optText">Alene</span></label>
            <label class="opt"><input type="radio" name="q6" value="Sammen med √©n anden"><span class="optText">Sammen med √©n anden</span></label>
            <label class="opt"><input type="radio" name="q6" value="I en lille gruppe"><span class="optText">I en lille gruppe</span></label>
            <label class="opt"><input type="radio" name="q6" value="Forskelligt ‚Äì det kommer an p√• opgaven"><span class="optText">Forskelligt ‚Äì det kommer an p√• opgaven</span></label>
          </div>
        </div>

        <!-- 7 -->
        <div class="q">
          <div class="qTop">
            <div class="qNum">7</div>
            <div class="qText">üõ†Ô∏è N√•r jeg skal l√¶re noget nyt, hj√¶lper det mig mest at ‚Ä¶</div>
            <div class="qRule">max 2</div>
          </div>
          <div class="options" aria-label="Q7">
            <label class="opt"><input type="checkbox" name="q7" value="F√• det forklaret"><span class="optText">F√• det forklaret</span></label>
            <label class="opt"><input type="checkbox" name="q7" value="Se et eksempel"><span class="optText">Se et eksempel</span></label>
            <label class="opt"><input type="checkbox" name="q7" value="Pr√∏ve selv"><span class="optText">Pr√∏ve selv</span></label>
            <label class="opt"><input type="checkbox" name="q7" value="Tale med andre om det"><span class="optText">Tale med andre om det</span></label>
            <label class="opt"><input type="checkbox" name="q7" value="Tegne eller skrive"><span class="optText">Tegne eller skrive</span></label>
          </div>
        </div>

        <!-- 8 -->
        <div class="q">
          <div class="qTop">
            <div class="qNum">8</div>
            <div class="qText">üß† N√•r noget er sv√¶rt, vil jeg helst ‚Ä¶</div>
            <div class="qRule">max 1</div>
          </div>
          <div class="options" role="radiogroup" aria-label="Q8">
            <label class="opt"><input type="radio" name="q8" value="Kunne sp√∏rge l√¶rerne"><span class="optText">Kunne sp√∏rge l√¶rerne</span></label>
            <label class="opt"><input type="radio" name="q8" value="Pr√∏ve selv f√∏rst"><span class="optText">Pr√∏ve selv f√∏rst</span></label>
            <label class="opt"><input type="radio" name="q8" value="Sp√∏rge en ven"><span class="optText">Sp√∏rge en ven</span></label>
          </div>
        </div>

        <!-- 9 -->
        <div class="q">
          <div class="qTop">
            <div class="qNum">9</div>
            <div class="qText">üéõÔ∏è N√•r vi arbejder i matematik, vil jeg helst ‚Ä¶</div>
            <div class="qRule">max 1</div>
          </div>
          <div class="options" role="radiogroup" aria-label="Q9">
            <label class="opt"><input type="radio" name="q9" value="Have faste opgaver"><span class="optText">Have faste opgaver</span></label>
            <label class="opt"><input type="radio" name="q9" value="Kunne skifte mellem opgaver undervejs"><span class="optText">Kunne skifte mellem opgaver undervejs</span></label>
          </div>
        </div>

        <!-- 10 -->
        <div class="q">
          <div class="qTop">
            <div class="qNum">10</div>
            <div class="qText">üîÑ Jeg kan godt lide at ‚Ä¶</div>
            <div class="qRule">max 1</div>
          </div>
          <div class="options" role="radiogroup" aria-label="Q10">
            <label class="opt"><input type="radio" name="q10" value="Arbejde l√¶nge med √©n opgave"><span class="optText">Arbejde l√¶nge med √©n opgave</span></label>
            <label class="opt"><input type="radio" name="q10" value="Arbejde med flere sm√• opgaver"><span class="optText">Arbejde med flere sm√• opgaver</span></label>
          </div>
        </div>

        <!-- 11 -->
        <div class="q">
          <div class="qTop">
            <div class="qNum">11</div>
            <div class="qText">‚≠ê Det g√∏r mig stolt i skolen, n√•r ‚Ä¶</div>
            <div class="qRule">max 1</div>
          </div>
          <div class="options" role="radiogroup" aria-label="Q11">
            <label class="opt"><input type="radio" name="q11" value="Jeg forst√•r noget nyt"><span class="optText">Jeg forst√•r noget nyt</span></label>
            <label class="opt"><input type="radio" name="q11" value="Jeg bliver bedre end f√∏r"><span class="optText">Jeg bliver bedre end f√∏r</span></label>
            <label class="opt"><input type="radio" name="q11" value="Jeg klarer en sv√¶r opgave"><span class="optText">Jeg klarer en sv√¶r opgave</span></label>
          </div>
        </div>

        <!-- 12 -->
        <div class="q">
          <div class="qTop">
            <div class="qNum">12</div>
            <div class="qText">üéí Jeg vil gerne blive bedre til ‚Ä¶</div>
            <div class="qRule">flere</div>
          </div>
          <div class="options" aria-label="Q12">
            <label class="opt"><input type="checkbox" name="q12" value="At koncentrere mig"><span class="optText">At koncentrere mig</span></label>
            <label class="opt"><input type="checkbox" name="q12" value="At arbejde selv"><span class="optText">At arbejde selv</span></label>
            <label class="opt"><input type="checkbox" name="q12" value="At arbejde sammen med andre"><span class="optText">At arbejde sammen med andre</span></label>
            <label class="opt"><input type="checkbox" name="q12" value="At forklare mine tanker"><span class="optText">At forklare mine tanker</span></label>
            <label class="opt"><input type="checkbox" name="q12" value="At turde pr√∏ve sv√¶re ting"><span class="optText">At turde pr√∏ve sv√¶re ting</span></label>
          </div>
        </div>

        <!-- 13 -->
        <div class="q">
          <div class="qTop">
            <div class="qNum">13</div>
            <div class="qText">üåà Hvis skolen var helt perfekt for mig, ville den ‚Ä¶</div>
            <div class="qRule">flere</div>
          </div>
          <div class="options" aria-label="Q13">
            <label class="opt"><input type="checkbox" name="q13" value="Have flere valg"><span class="optText">Have flere valg</span></label>
            <label class="opt"><input type="checkbox" name="q13" value="Have flere kreative opgaver"><span class="optText">Have flere kreative opgaver</span></label>
            <label class="opt"><input type="checkbox" name="q13" value="Have mere ro"><span class="optText">Have mere ro</span></label>
            <label class="opt"><input type="checkbox" name="q13" value="Have mere bev√¶gelse"><span class="optText">Have mere bev√¶gelse</span></label>
            <label class="opt"><input type="checkbox" name="q13" value="Have mere leg og fantasi"><span class="optText">Have mere leg og fantasi</span></label>
            <label class="opt"><input type="checkbox" name="q13" value="Have mere tid til fordybelse"><span class="optText">Have mere tid til fordybelse</span></label>
          </div>
        </div>

        <!-- 14 -->
        <div class="q">
          <div class="qTop">
            <div class="qNum">14</div>
            <div class="qText">‚úçÔ∏è Er der noget, vi som l√¶rere skal vide om dig?</div>
            <div class="qRule">frivilligt</div>
          </div>
          <div class="inline">
            <input class="field" id="q14" placeholder="Skriv her (valgfrit) ‚Ä¶" autocomplete="off" />
          </div>
        </div>
      </form>

      <div class="actions">
        <div class="btns">
          <button class="primary" type="button" id="buildBtn">üñ®Ô∏è Lav og print mit matematik-ark</button>
          <button class="secondary teacherOnly" type="button" id="downloadBtn">‚¨áÔ∏è Download .txt</button>
          <button class="ghost" type="button" id="resetBtn">üîÑ Nulstil</button>
        </div>
        <div class="hint" id="status"></div>
      </div>
    </section>

    <!-- Teacher-only prompt view (hidden) -->
    <aside class="card teacherOnly" aria-label="ChatGPT prompt">
      <div class="cardHead">
        <h2 class="cardTitle">üìÑ Tekst til ChatGPT</h2>
        <p class="sub">Prompten vises her (kun til l√¶rer).</p>
      </div>
      <div class="content">
        <textarea id="promptOut" placeholder="Tryk ‚ÄúLav og print‚Äù ‚Ä¶"></textarea>
        <p class="note">Download gemmer prompten som .txt (klar til copy/paste).</p>
      </div>
      <div class="actions">
        <div class="btns">
          <button class="secondary" type="button" id="copyBtn">üìã Kopi√©r</button>
          <button class="ghost" type="button" id="selectBtn">üñäÔ∏è Mark√©r alt</button>
        </div>
        <div class="hint">‚úÖ Klar</div>
      </div>
    </aside>

    <!-- PRINT ONLY -->
    <section class="printSheet" id="printSheet">
      <p class="printTitle" id="printTitle"></p>
      <pre id="resultOut"></pre>
    </section>

  </main>

  <div class="toast" id="toast">Kopieret ‚úÖ</div>

  <script>
    // ‚úÖ Din Cloudflare Worker endpoint:
    const WORKER_URL = "https://sporgeskema.ahalkjaer.workers.dev";

    const $ = (sel, el=document) => el.querySelector(sel);
    const $$ = (sel, el=document) => Array.from(el.querySelectorAll(sel));

    const toast = (msg) => {
      const t = $("#toast");
      t.textContent = msg;
      t.classList.add("show");
      setTimeout(()=>t.classList.remove("show"), 1200);
    };

    // Enforce max checks
    const enforceMaxChecks = (name, max) => {
      const boxes = $$(`input[type="checkbox"][name="${name}"]`);
      boxes.forEach(b => b.addEventListener("change", () => {
        const checked = boxes.filter(x => x.checked);
        if (checked.length > max) {
          b.checked = false;
          toast(`Max ${max} kryds her üôÇ`);
        }
      }));
    };
    enforceMaxChecks("q5", 2);
    enforceMaxChecks("q7", 2);

    const getRadio = (name) => {
      const r = $(`input[type="radio"][name="${name}"]:checked`);
      return r ? r.value : "";
    };
    const getChecks = (name) => {
      return $$(`input[type="checkbox"][name="${name}"]:checked`).map(x=>x.value);
    };

    // --- Prompt builder ---
    const buildPrompt = () => {
      const studentName = ($("#studentName").value || "").trim() || "Elev";
      const studentClass = ($("#studentClass").value || "").trim() || "4Y";

      const q1 = getRadio("q1");
      const q2 = getRadio("q2");
      const q3 = getChecks("q3");
      const q4 = getChecks("q4");
      const q4other = ($("#q4other").value || "").trim();
      const q5 = getChecks("q5");
      const q6 = getRadio("q6");
      const q7 = getChecks("q7");
      const q8 = getRadio("q8");
      const q9 = getRadio("q9");
      const q10 = getRadio("q10");
      const q11 = getRadio("q11");
      const q12 = getChecks("q12");
      const q13 = getChecks("q13");
      const q14 = ($("#q14").value || "").trim();

      const answers = [
        `Navn: ${studentName}`,
        `Klasse: ${studentClass}`,
        `1) ${q1 || "‚Äî"}`,
        `2) ${q2 || "‚Äî"}`,
        `3) ${q3.length ? q3.join(", ") : "‚Äî"}`,
        `4) ${q4.length ? q4.join(", ") : "‚Äî"}${q4other ? ` (Uddyb: ${q4other})` : ""}`,
        `5) ${q5.length ? q5.join(", ") : "‚Äî"}`,
        `6) ${q6 || "‚Äî"}`,
        `7) ${q7.length ? q7.join(", ") : "‚Äî"}`,
        `8) ${q8 || "‚Äî"}`,
        `9) ${q9 || "‚Äî"}`,
        `10) ${q10 || "‚Äî"}`,
        `11) ${q11 || "‚Äî"}`,
        `12) ${q12.length ? q12.join(", ") : "‚Äî"}`,
        `13) ${q13.length ? q13.join(", ") : "‚Äî"}`,
        `14) ${q14 || "‚Äî"}`
      ].join("\n");

      const prompt =
`Du er en dansk matematikl√¶rer for 4. klasse og didaktisk designer.

OPGAVE:
Lav et PERSONLIGT matematikforl√∏b til eleven ud fra elevens besvarelse.

KRAV (skal overholdes):
- Varighed: 2 lektioner √° 45 minutter (2√ó45 min).
- Output: KUN opgaver/arbejdsark-tekst. Ingen beskeder til l√¶rer eller elever. Ingen introduktion. Ingen forklaringer. Bare opgaverne.
- Differentiering: For hver lektion skal der v√¶re 3 spor: Basis / Plus / Challenge.
- Realistisk 4. klasse med stor niveauspredning: Basis skal kunne l√∏ses af elever der k√¶mper; Challenge m√• str√¶kke de st√¶rke.
- Brug elevens interesser aktivt i opgavekontekster (Q4 + evt. uddybning).
- Respekt√©r elevens pr√¶ferencer for ro/samarbejde/bev√¶gelse/valg og l√¶ringsstrategier (Q5‚ÄìQ10).
- Giv nok opgaver til at fylde 45 minutter per lektion.
- Opgaverne skal v√¶re konkrete (antal, tydelige delsp√∏rgsm√•l).

VIGTIG EKSTRA (bogside-look i dit svar):
- Skriv opgaverne som en ‚Äúrigtig matematikbog/arbejdsbogside‚Äù i ren tekst: tydelige bokse/rammer og luft.
- Brug gerne ASCII-bokse (‚îå ‚îÄ ‚îê ‚îÇ ‚îî ‚îò) eller tydelige overskrifter/linjer.
- Inds√¶t en lille progress-ting i layoutet (fx ‚ÄúLektion 1: 1/3, 2/3, 3/3‚Äù eller lign.).
- Inds√¶t et lille tjekpunkt midtvejs: ‚ÄúStop og tjek: Har du styr p√• opgaven?‚Äù (kun √©n linje).
- Minimal pynt, print-venligt (sort/hvid-agtigt). Ikke ‚Äúweb‚Äù-sprog.

FORMAT (skal bruges pr√¶cist):
LEKTION 1 (45 min)
BASIS
1) ‚Ä¶
2) ‚Ä¶
3) ‚Ä¶
PLUS
1) ‚Ä¶
2) ‚Ä¶
3) ‚Ä¶
CHALLENGE
1) ‚Ä¶
2) ‚Ä¶
3) ‚Ä¶

LEKTION 2 (45 min)
BASIS
1) ‚Ä¶
2) ‚Ä¶
3) ‚Ä¶
PLUS
1) ‚Ä¶
2) ‚Ä¶
3) ‚Ä¶
CHALLENGE
1) ‚Ä¶
2) ‚Ä¶
3) ‚Ä¶

ELEVENS SVAR:
${answers}
`;

      // teacher-only textarea (hidden in UI)
      const ta = $("#promptOut");
      if (ta) ta.value = prompt;

      return { prompt, studentName, studentClass };
    };

    // --- Download prompt (.txt) (teacher-only) ---
    const downloadTxt = () => {
      const { prompt, studentName, studentClass } = buildPrompt();
      const safeName = (studentName || "Elev")
        .replace(/[^\w\-√¶√∏√•√Ü√ò√Ö ]+/g, "")
        .trim()
        .replace(/\s+/g, "_");
      const safeClass = (studentClass || "4Y")
        .replace(/[^\w\-]+/g, "")
        .trim();
      const filename = `${safeClass}_ChatGPT_prompt_${safeName}.txt`;

      const blob = new Blob([prompt], { type: "text/plain;charset=utf-8" });
      const url = URL.createObjectURL(blob);

      const a = document.createElement("a");
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();

      URL.revokeObjectURL(url);
      toast("Downloaded ‚úÖ");
    };

    // --- Call Cloudflare Worker ‚Üí get worksheet ‚Üí show + print ---
    async function generateWorksheetAndPrint(){
      const { prompt, studentName, studentClass } = buildPrompt();

      $("#buildBtn").disabled = true;
      $("#status").textContent = "‚è≥ Laver dit ark‚Ä¶";

      const sheet = $("#printSheet");
      const out = $("#resultOut");
      const title = $("#printTitle");

      sheet.style.display = "block";     // vigtigt: synligt f√∏r print
      out.textContent = "";
      title.textContent = `üìÑ Matematik-ark (${studentName} ‚Äì ${studentClass})`;

      try{
        const res = await fetch(WORKER_URL, {
          method: "POST",
          headers: {"Content-Type":"application/json"},
          body: JSON.stringify({ prompt })
        });

        if(!res.ok){
          const err = await res.text();
          $("#status").textContent = "‚ùå Fejl fra API";
          alert("Fejl fra API:\n\n" + err);
          return;
        }

        const text = await res.text();
        out.textContent = text;

        $("#status").textContent = "‚úÖ Klar ‚Äì √•bner print‚Ä¶";

        // Vent 2 frames s√• DOM n√•r at tegne teksten f√∏r print
        await new Promise(r => requestAnimationFrame(r));
        await new Promise(r => requestAnimationFrame(r));
        setTimeout(() => window.print(), 150);

      }catch(e){
        $("#status").textContent = "‚ùå Netv√¶rksfejl";
        alert("Netv√¶rksfejl:\n\n" + (e?.message || e));
      }finally{
        $("#buildBtn").disabled = false;
      }
    }

    // Buttons
    $("#buildBtn").addEventListener("click", generateWorksheetAndPrint);

    const dl = $("#downloadBtn");
    if (dl) dl.addEventListener("click", downloadTxt);

    $("#resetBtn").addEventListener("click", () => {
      $("#survey").reset();
      $("#studentName").value = "";
      $("#studentClass").value = "";
      $("#q4other").value = "";
      $("#q14").value = "";
      const ta = $("#promptOut"); if (ta) ta.value = "";
      $("#status").textContent = "";
      $("#printSheet").style.display = "none";
      $("#resultOut").textContent = "";
      $("#printTitle").textContent = "";
      toast("Nulstillet üîÑ");
    });

    const selBtn = $("#selectBtn");
    if (selBtn) selBtn.addEventListener("click", () => {
      const ta = $("#promptOut");
      ta.focus();
      ta.select();
      toast("Markeret ‚úçÔ∏è");
    });

    const copyBtn = $("#copyBtn");
    if (copyBtn) copyBtn.addEventListener("click", async () => {
      const text = ($("#promptOut")?.value || "").trim() || buildPrompt().prompt.trim();
      if (!text) { toast("Lav prompt f√∏rst üôÇ"); return; }
      try{
        await navigator.clipboard.writeText(text);
        toast("Kopieret ‚úÖ");
      }catch(e){
        const ta = $("#promptOut");
        ta.focus(); ta.select();
        document.execCommand("copy");
        toast("Kopieret ‚úÖ");
      }
    });
  </script>
</body>
</html>
